{"description": "Enterprise techniques used by OwaAuth, ATT&CK software S0072 v1.0", "name": "OwaAuth (S0072)", "domain": "mitre-enterprise", "version": "2.1", "techniques": [{"score": 1, "techniqueID": "T1022", "comment": "OwaAuth DES-encrypts captured credentials using the key 12345678 before writing the credentials to a log file."}, {"score": 1, "techniqueID": "T1073", "comment": "OwaAuth has been loaded onto Exchange servers and disguised as an ISAPI filter (DLL file). The IIS w3wp.exe process then loads the malicious DLL."}, {"score": 1, "techniqueID": "T1083", "comment": "OwaAuth has a command to list its directory and logical drives."}, {"score": 1, "techniqueID": "T1056", "comment": "OwaAuth captures and DES-encrypts credentials before writing the username and password to a log file, C:\\log.txt."}, {"score": 1, "techniqueID": "T1036", "comment": "OwaAuth uses the filename owaauth.dll, which is a legitimate file that normally resides in %ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\Auth\\; the malicious file by the same name is saved in %ProgramFiles%\\Microsoft\\Exchange Server\\ClientAccess\\Owa\\bin\\."}, {"score": 1, "techniqueID": "T1071", "comment": "OwaAuth uses incoming HTTP requests with a username keyword and commands and handles them as instructions to perform actions."}, {"score": 1, "techniqueID": "T1099", "comment": "OwaAuth has a command to timestop a file or directory."}, {"score": 1, "techniqueID": "T1100", "comment": "OwaAuth is a Web shell that appears to be exclusively used by Threat Group-3390. It is installed as an ISAPI filter on Exchange servers and shares characteristics with the China Chopper Web shell."}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by OwaAuth", "color": "#66b1ff"}]}