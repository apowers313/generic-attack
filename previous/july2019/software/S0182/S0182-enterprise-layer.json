{"description": "Enterprise techniques used by FinFisher, ATT&CK software S0182 v1.2", "name": "FinFisher (S0182)", "domain": "mitre-enterprise", "version": "2.1", "techniques": [{"score": 1, "techniqueID": "T1134", "comment": "FinFisher uses token manipulation with NtFilterToken as part of UAC bypass."}, {"score": 1, "techniqueID": "T1009", "comment": "FinFisher contains junk code in its functions in an effort to confuse disassembly programs."}, {"score": 1, "techniqueID": "T1067", "comment": "Some FinFisher variants incorporate an MBR rootkit."}, {"score": 1, "techniqueID": "T1088", "comment": "FinFisher performs UAC bypass."}, {"score": 1, "techniqueID": "T1140", "comment": "FinFisher extracts and decrypts stage 3 malware, which is stored in encrypted resources."}, {"score": 1, "techniqueID": "T1038", "comment": "A FinFisher variant uses DLL search order hijacking."}, {"score": 1, "techniqueID": "T1073", "comment": "FinFisher uses DLL side-loading to load malicious programs."}, {"score": 1, "techniqueID": "T1083", "comment": "FinFisher enumerates directories and scans for certain files."}, {"score": 1, "techniqueID": "T1179", "comment": "FinFisher hooks processes by modifying IAT pointers to CreateWindowEx."}, {"score": 1, "techniqueID": "T1070", "comment": "FinFisher clears the system event logs."}, {"score": 1, "techniqueID": "T1036", "comment": "FinFisher renames one of its .dll files to uxtheme.dll in an apparent attempt to masquerade as a legitimate file."}, {"score": 1, "techniqueID": "T1050", "comment": "FinFisher creates a new Windows service with the malicious executable for persistence."}, {"score": 1, "techniqueID": "T1027", "comment": "FinFisher is heavily obfuscated in many ways, including through the use of spaghetti code in its functions in an effort to confuse disassembly programs. It also uses a custom XOR algorithm to obfuscate code."}, {"score": 1, "techniqueID": "T1057", "comment": "FinFisher checks its parent process for indications that it is running in a sandbox setup."}, {"score": 1, "techniqueID": "T1055", "comment": "FinFisher injects itself into various processes depending on whether it is low integrity or high integrity."}, {"score": 1, "techniqueID": "T1012", "comment": "FinFisher queries Registry values as part of its anti-sandbox checks."}, {"score": 1, "techniqueID": "T1060", "comment": "FinFisher establishes persistence by creating the Registry key HKCU\\Software\\Microsoft\\Windows\\Run."}, {"score": 1, "techniqueID": "T1113", "comment": "FinFisher takes a screenshot of the screen and displays it on top of all other windows for few seconds in an apparent attempt to hide some messages showed by the system during the setup process."}, {"score": 1, "techniqueID": "T1063", "comment": "FinFisher probes the system to check for antimalware processes."}, {"score": 1, "techniqueID": "T1045", "comment": "A FinFisher variant uses a custom packer."}, {"score": 1, "techniqueID": "T1082", "comment": "FinFisher checks if the victim OS is 32 or 64-bit."}, {"score": 1, "techniqueID": "T1497", "comment": "FinFisher probes the system to check for sandbox/virtualized environments."}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by FinFisher", "color": "#66b1ff"}]}