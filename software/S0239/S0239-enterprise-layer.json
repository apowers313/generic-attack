{"description": "Enterprise techniques used by Bankshot, ATT&CK software S0239 v1.0", "name": "Bankshot (S0239)", "domain": "mitre-enterprise", "version": "2.2", "techniques": [{"score": 1, "techniqueID": "T1134", "comment": "Bankshot grabs a user token using WTSQueryUserToken and then creates a process by impersonating a logged-on user.[1]"}, {"score": 1, "techniqueID": "T1087", "comment": "Bankshot gathers domain and account names/information through process monitoring.[1]"}, {"score": 1, "techniqueID": "T1119", "comment": "Bankshot recursively generates a list of files within a directory and sends them back to the control server.[1]"}, {"score": 1, "techniqueID": "T1059", "comment": "Bankshot uses the command-line interface to execute arbitrary commands.[1][2]"}, {"score": 1, "techniqueID": "T1132", "comment": "Bankshot encodes commands from the control server using a range of characters and gzip.[1]"}, {"score": 1, "techniqueID": "T1005", "comment": "Bankshot collects files from the local system.[1]"}, {"score": 1, "techniqueID": "T1001", "comment": "Bankshot generates a false TLS handshake using a public certificate to disguise C2 network communications.[2]"}, {"score": 1, "techniqueID": "T1140", "comment": "Bankshot decodes embedded XOR strings.[2]"}, {"score": 1, "techniqueID": "T1106", "comment": "Bankshot creates processes using the Windows API calls: CreateProcessA() and CreateProcessAsUserA().[1]"}, {"score": 1, "techniqueID": "T1041", "comment": "Bankshot exfiltrates data over its C2 channel.[1]"}, {"score": 1, "techniqueID": "T1203", "comment": "Bankshot leverages a known zero-day vulnerability in Adobe Flash to execute the implant into the victims\u2019 machines.[1]"}, {"score": 1, "techniqueID": "T1083", "comment": "Bankshot searches for files on the victim's machine.[2]"}, {"score": 1, "techniqueID": "T1107", "comment": "Bankshot marks files to be deleted upon the next system reboot and uninstalls and removes itself from the system.[1]"}, {"score": 1, "techniqueID": "T1070", "comment": "Bankshot delets all artifacts associated with the malware from the infected machine.[2]"}, {"score": 1, "techniqueID": "T1031", "comment": "Bankshot can terminate a specific process by its process id.[1][2]"}, {"score": 1, "techniqueID": "T1112", "comment": "Bankshot writes data into the Registry key HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Pniumj.[2]"}, {"score": 1, "techniqueID": "T1057", "comment": "Bankshot identifies processes and collects the process ids.[1]"}, {"score": 1, "techniqueID": "T1012", "comment": "Bankshot searches for certain Registry keys to be configured before executing the payload.[2]"}, {"score": 1, "techniqueID": "T1105", "comment": "Bankshot uploads files and secondary payloads to the victim's machine.[2]"}, {"score": 1, "techniqueID": "T1071", "comment": "Bankshot uses HTTP for command and control communication.[1]"}, {"score": 1, "techniqueID": "T1082", "comment": "Bankshot gathers system information, network addresses, disk type, disk free space, and the operation system version.[1][2]"}, {"score": 1, "techniqueID": "T1099", "comment": "Bankshot modifies the time of a file as specified by the control server.[1]"}, {"score": 1, "techniqueID": "T1065", "comment": "Bankshot binds and listens on port 1058.[2]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Bankshot", "color": "#66b1ff"}]}