{"description": "Enterprise techniques used by Zebrocy, ATT&CK software S0251 v2.0", "name": "Zebrocy (S0251)", "domain": "mitre-enterprise", "version": "2.2", "techniques": [{"score": 1, "techniqueID": "T1119", "comment": "Zebrocy scans the system and automatically collects files with the following extensions: .doc, .docx, ,.xls, .xlsx, .pdf, .pptx, .rar, .zip, .jpg, .jpeg, .bmp, .tiff, .kum, .tlg, .sbx, .cr, .hse, .hsf, and .lhz.[4][5]"}, {"score": 1, "techniqueID": "T1059", "comment": "Zebrocy uses cmd.exe to execute commands on the system.[5]"}, {"score": 1, "techniqueID": "T1503", "comment": "Zebrocy has the capability to upload dumper tools that extract credentials from web browsers and store them in database files.[5]"}, {"score": 1, "techniqueID": "T1094", "comment": "Zebrocy uses raw sockets to communicate with its C2 server.[1]"}, {"score": 1, "techniqueID": "T1132", "comment": "Zebrocy has used URL/Percent Encoding on data exfiltrated via HTTP POST requests.[6]"}, {"score": 1, "techniqueID": "T1022", "comment": "Zebrocy uses an encryption method similar to RC4 as well as AES to encrypt data before exfiltration.[7][4]"}, {"score": 1, "techniqueID": "T1074", "comment": "Zebrocy stores all collected information in a single file before exfiltration.[4]"}, {"score": 1, "techniqueID": "T1140", "comment": "Zebrocy decodes its secondary payload and writes it to the victim\u2019s machine. Zebrocy also uses AES and XOR to decrypt strings and payloads.[2][4]"}, {"score": 1, "techniqueID": "T1041", "comment": "Zebrocy has exfiltrated data to the designated C2 server using HTTP POST requests.[6]"}, {"score": 1, "techniqueID": "T1083", "comment": "Zebrocy searches for files that are 60mb and less and contain the following extensions: .doc, .docx, .xls, .xlsx, .ppt, .pptx, .exe, .zip, and .rar. Zebrocy also runs the echo %APPDATA% command to list the contents of the directory. Zebrocy can obtain the current execution path as well as perform drive enumeration.[7][4][5][6]"}, {"score": 1, "techniqueID": "T1107", "comment": "Zebrocy has a command to delete files and directories.[4][5]"}, {"score": 1, "techniqueID": "T1179", "comment": "Zebrocy installs an application-defined Windows hook to get notified when a network drive has been attached, so it can then use the hook to call its RecordToFile file stealing method.[7]"}, {"score": 1, "techniqueID": "T1037", "comment": "Zebrocy performs persistence via adding a Registry key with a logon script.[4]"}, {"score": 1, "techniqueID": "T1135", "comment": "Zebrocy identifies network drives when they are added to victim systems.[7]"}, {"score": 1, "techniqueID": "T1120", "comment": "Zebrocy enumerates information about connected storage devices.[2]"}, {"score": 1, "techniqueID": "T1057", "comment": "Zebrocy uses the tasklist and wmic process get Capture, ExecutablePath commands to gather the processes running on the system.[2][4][3][5][6]"}, {"score": 1, "techniqueID": "T1012", "comment": "Zebrocy executes the reg query command to obtain information in the Registry.[5]"}, {"score": 1, "techniqueID": "T1060", "comment": "Zebrocy creates an entry in a Registry Run key for the malware to execute on startup.[4][5][6]"}, {"score": 1, "techniqueID": "T1105", "comment": "Zebrocy obtains additional code to execute on the victim's machine, including the downloading of a secondary payload.[1][2][5][6]"}, {"score": 1, "techniqueID": "T1113", "comment": "A variant of Zebrocy captures screenshots of the victim\u2019s machine in JPEG and BMP format.[2][4][3][5][6]"}, {"score": 1, "techniqueID": "T1045", "comment": "Zebrocy's Delphi variant was packed with UPX.[3][6]"}, {"score": 1, "techniqueID": "T1071", "comment": "Zebrocy uses HTTP, SMTP, and POP3 for C2.[1][2][4][3][5][6]"}, {"score": 1, "techniqueID": "T1032", "comment": "Zebrocy uses SSL and AES ECB for encrypting C2 communications.[4][5]"}, {"score": 1, "techniqueID": "T1082", "comment": "Zebrocy collects the OS version, computer name and serial number for the storage volume C:. Zebrocy also runs the systeminfo command to gather system information.[1][2][4][3][5][6]"}, {"score": 1, "techniqueID": "T1016", "comment": "Zebrocy runs the ipconfig /all command.[5]"}, {"score": 1, "techniqueID": "T1049", "comment": "Zebrocy uses netstat -aon to gather network connection information.[5]"}, {"score": 1, "techniqueID": "T1033", "comment": "Zebrocy gets the username from the system.[4]"}, {"score": 1, "techniqueID": "T1124", "comment": "Zebrocy gathers the current time zone and date information from the system.[4]"}, {"score": 1, "techniqueID": "T1065", "comment": "Zebrocy uses port 465 for C2.[4]"}, {"score": 1, "techniqueID": "T1047", "comment": "One variant of Zebrocy uses WMI queries to gather information.[3]"}], "gradient": {"colors": ["#ffffff", "#66b1ff"], "minValue": 0, "maxValue": 1}, "legendItems": [{"label": "used by Zebrocy", "color": "#66b1ff"}]}